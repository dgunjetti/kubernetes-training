https://www.youtube.com/watch?v=uSxlgK1bCuA

problem with containers and state.

The problem is containers are ephemeral
if container were to crash, kubelet will restart it.
but files written in container filesystem will be lost.
it starts with a clean slate.

other problem is
when running multiple containers in a pod, it is often required to share files between
those containers.

challenges with abstrating the storage is
so many different types of storage.
block stores - s3, gcs
sql database
pub sub systems
time series database
file storage.

kubernetes provides abstraction for file and block storage.
not for sql or other storage.
data path for both file and block are standardised, posix, iscsi

the way file and block are abstracted is via volume plugin.
volume plugin references to block device or mounted file system.
it is accessible to all containers in pod.
volume plugin specify how the volume is setup in pod and medium that backs it.
life time of volume is that of pod or be persistent beyond the pod.

kubernetes has many volume plugins
remote storage - gce, ebs, afs, 
network attached storage that persists the beyond the life time of indiviual pod.

ephemaral storage - life cycle is tied to given pod.
emptydir, secret, config map

hostpath that should not be used.

ephemeral storage
- temp scratch file space from host machine.
- data exists only for duratin of pod
- reference inline in pod
volume plugin is emptydir.

handon with empty dir with 2 containers.

portability : even if we move yaml to any other cluster it will the exactly the same way
regardless of cluster we are running on.

set of volume plugins built on top of empty dir.
secrate volume
configamp volume
downwardAPI volume
they create an empty dir and prepopulate with some data.
ex: secret volume will expose secret object in api as file in volume.
if u had the appliation that reads the credentials from a file.
it works the same way without any changes.


remote storage.
data persists beyond the life of pod.
this allows the data peristented so that u can have statefull services.
referenced in pod either inline or via pv/pvc.
this decouple the storage from compute, so allowing pods to be moved around.
explain more..

show yaml for ebs, pd.






